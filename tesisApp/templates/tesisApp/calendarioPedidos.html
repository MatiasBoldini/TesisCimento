{% extends './layout.html' %}

{% block title %}
    Página Calendario de Pedidos
{% endblock %}

{% block content %}
    
    <div class="container d-flex justify-content-center align-items-center vh-90">
        <div class="col-lg-6 columnaCentral">
            <section class="container mt-custom mb-4"> <!-- Mantenemos la clase mt-custom -->
                <div class="row mb-2"> <!-- Reducimos el margen para un ajuste más preciso -->
                    <div class="col-12 text-center">
                        <h1 class="titulo-principal">Calendario de pedidos</h1>
                    </div>
                </div>

                <div class="container mt-3">
                <div >
                    <label for="meses" style="color: white;">Selecciona un mes:</label>
                    <select id="mesSeleccionado" name="meses" class="form-control">
                        <option value="0" disabled selected>Seleccionar...</option>
                        <option value="1">Enero</option>
                        <option value="2">Febrero</option>
                        <option value="3">Marzo</option>
                        <option value="4">Abril</option>
                        <option value="5">Mayo</option>
                        <option value="6">Junio</option>
                        <option value="7">Julio</option>
                        <option value="8">Agosto</option>
                        <option value="9">Septiembre</option>
                        <option value="10">Octubre</option>
                        <option value="11">Noviembre</option>
                        <option value="12">Diciembre</option>
                    </select>
                    <!-- <button id="botonMostrar" class="btn btn-primary">Mostrar Pedidos</button> -->
                </div>

                <div id="calendario" class="mt-2"></div>
            </div>


            <div class="contenedor-todo">

                <div class="grilla">            
                  <div class="contenedor-tabla">

                    {% if fecha %}
                        <h1 style="color: white;">Fecha seleccionada: {{ fecha }} </h1>     
                    {% endif %}


                    
                    <table id="tabla" class="tablaCalendar">
                        <thead>
                            <tr>
                                <th>Id. Pedido</th>
                                <th>Cliente</th>
                                <th>Fecha Entrega</th>
                                <th>Cantidad</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% csrf_token %}
                        {% if pedidos %}
                            {% for pedido in pedidos %}
                                <tr>
                                    <td>{{ pedido.IdPedido }}</td>
                                    <td>{{ pedido.DNICliente }}</td>
                                    <td>{{ pedido.FechaDeEntrega }}</td>
                                    <td>{{ pedido.CantidadM3 }}</td>
                                    <td>{{ pedido.EstadoPedido }}</td>
                                </tr>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <td colspan="5">No hay pedidos disponibles.</td>
                            </tr>
                        {% endif %}
                        </tbody>
                    </table>
                  </div>
                </div>
            
            </div> 

        </section>


        <script>
            var fechasDeEntrega = {{ fechas_de_entrega|safe }};
    
            // Agregar evento de cambio al dropdown
            document.getElementById('mesSeleccionado').addEventListener('change', onMesSeleccionadoChange);


            function onMesSeleccionadoChange() {
            const mesSeleccionado = document.getElementById('mesSeleccionado').value;
        
                
            mostrarFechasEnCalendario(parseInt(mesSeleccionado), fechasDeEntrega);

        }
            
        </script>





        </div>
    </div>
{% endblock %}